# HyperBox Configuration Templates for Different Deployment Scenarios

# ============================================================================
# Production Configuration
# ============================================================================
# File: /etc/hyperbox/hyperbox-production.conf
# Usage: Production deployments with high performance requirements

[daemon]
# Socket/network configuration
listen_addr = "0.0.0.0:9999"
data_dir = "/var/lib/hyperbox"
config_dir = "/etc/hyperbox"
log_level = "warn"

# Performance settings
max_connections = 1000
connection_timeout_secs = 30
read_timeout_secs = 10
write_timeout_secs = 10

[cache]
# Larger cache for production
size_mb = 2048
ttl_seconds = 7200
compression = true
compression_level = 6
eviction_policy = "lru"
# Memory-mapped I/O for large caches
use_mmap = true

[deduplication]
enabled = true
hash_algorithm = "blake3"
# Optimize for CPU vs memory
min_layer_size = 1048576  # 1 MB minimum
max_concurrent_dedup = 8
# Bloom filter for pre-filtering
enable_bloom_filter = true
bloom_filter_capacity = 1000000

[prediction]
enabled = true
update_interval = 300  # 5 minutes
min_confidence = 0.70  # 70% confidence threshold
max_predictions = 20
# Use historical data from past 7 days
history_retention_days = 7
# Enable incremental model updates
incremental_models = true

[prewarming]
enabled = true
parallel_ops = 8
timeout_seconds = 60
# Aggressive warming in production
prefetch_depth = 3
# Enable batch warming for efficiency
batch_warming = true
batch_size = 100

[monitoring]
metrics_enabled = true
metrics_port = 8888
collection_interval = 10
# Detailed metrics in production
enable_histograms = true
enable_percentiles = true
# Export to external systems
export_enabled = true
export_interval = 30
export_targets = ["http://prometheus:9090/api/v1/write"]

[resilience]
# Retry configuration
max_retries = 5
initial_retry_delay_ms = 100
max_retry_delay_ms = 10000
retry_backoff_multiplier = 2.0

# Circuit breaker
circuit_breaker_enabled = true
circuit_breaker_threshold = 50  # % failure rate
circuit_breaker_timeout_secs = 60

# Degradation policy
graceful_degradation = true
fallback_to_baseline = true

---
# ============================================================================
# Development Configuration
# ============================================================================
# File: /etc/hyperbox/hyperbox-development.conf
# Usage: Development and testing environments

[daemon]
listen_addr = "127.0.0.1:9999"
data_dir = "/tmp/hyperbox"
config_dir = "/etc/hyperbox"
log_level = "debug"
max_connections = 100

[cache]
size_mb = 256
ttl_seconds = 1800
compression = false  # Disable for faster testing
eviction_policy = "lru"
use_mmap = false

[deduplication]
enabled = true
hash_algorithm = "blake3"
min_layer_size = 1048576
max_concurrent_dedup = 2
enable_bloom_filter = false

[prediction]
enabled = true
update_interval = 60  # More frequent updates
min_confidence = 0.50  # Lower threshold for testing
max_predictions = 5
history_retention_days = 1
incremental_models = false

[prewarming]
enabled = true
parallel_ops = 2
timeout_seconds = 30
prefetch_depth = 1
batch_warming = false

[monitoring]
metrics_enabled = true
metrics_port = 8888
collection_interval = 5  # More frequent
enable_histograms = true
enable_percentiles = true
export_enabled = false  # No external export in dev

[resilience]
max_retries = 3
initial_retry_delay_ms = 50
max_retry_delay_ms = 1000
retry_backoff_multiplier = 2.0
circuit_breaker_enabled = false
graceful_degradation = true
fallback_to_baseline = true

---
# ============================================================================
# Kubernetes Configuration
# ============================================================================
# File: hyperbox-config ConfigMap in K8s
# Usage: Kubernetes deployments (embedded in ConfigMap)

[daemon]
listen_addr = "0.0.0.0:9999"
data_dir = "/var/lib/hyperbox"
config_dir = "/etc/hyperbox"
log_level = "info"
max_connections = 500

[cache]
size_mb = 1024
ttl_seconds = 3600
compression = true
compression_level = 4
eviction_policy = "lru"
use_mmap = true

[deduplication]
enabled = true
hash_algorithm = "blake3"
min_layer_size = 1048576
max_concurrent_dedup = 4
enable_bloom_filter = true
bloom_filter_capacity = 500000

[prediction]
enabled = true
update_interval = 300
min_confidence = 0.65
max_predictions = 15
history_retention_days = 7
incremental_models = true

[prewarming]
enabled = true
parallel_ops = 4
timeout_seconds = 45
prefetch_depth = 2
batch_warming = true
batch_size = 50

[monitoring]
metrics_enabled = true
metrics_port = 8888
collection_interval = 15
enable_histograms = true
enable_percentiles = false
export_enabled = true
export_interval = 30
export_targets = ["http://prometheus:9090/api/v1/write"]

[resilience]
max_retries = 4
initial_retry_delay_ms = 100
max_retry_delay_ms = 5000
retry_backoff_multiplier = 2.0
circuit_breaker_enabled = true
circuit_breaker_threshold = 50
circuit_breaker_timeout_secs = 30
graceful_degradation = true
fallback_to_baseline = true

---
# ============================================================================
# Edge/Embedded Configuration
# ============================================================================
# File: /etc/hyperbox/hyperbox-edge.conf
# Usage: Edge devices and resource-constrained environments

[daemon]
listen_addr = "0.0.0.0:9999"
data_dir = "/var/lib/hyperbox"
config_dir = "/etc/hyperbox"
log_level = "warn"
max_connections = 50

[cache]
size_mb = 128  # Minimal cache
ttl_seconds = 900
compression = true
compression_level = 9  # Maximum compression
eviction_policy = "lru"
use_mmap = false

[deduplication]
enabled = true
hash_algorithm = "blake3"
min_layer_size = 2097152  # 2 MB minimum (larger threshold)
max_concurrent_dedup = 1
enable_bloom_filter = true
bloom_filter_capacity = 100000

[prediction]
enabled = false  # Disabled on edge to save resources
update_interval = 600
min_confidence = 0.80
max_predictions = 3
history_retention_days = 1
incremental_models = false

[prewarming]
enabled = true
parallel_ops = 1
timeout_seconds = 20
prefetch_depth = 0  # No prefetching
batch_warming = false

[monitoring]
metrics_enabled = true
metrics_port = 8888
collection_interval = 60  # Less frequent
enable_histograms = false
enable_percentiles = false
export_enabled = false

[resilience]
max_retries = 2
initial_retry_delay_ms = 100
max_retry_delay_ms = 1000
retry_backoff_multiplier = 2.0
circuit_breaker_enabled = false
graceful_degradation = true
fallback_to_baseline = true

---
# ============================================================================
# High-Availability Configuration
# ============================================================================
# File: /etc/hyperbox/hyperbox-ha.conf
# Usage: High-availability clusters with replication

[daemon]
listen_addr = "0.0.0.0:9999"
data_dir = "/var/lib/hyperbox"
config_dir = "/etc/hyperbox"
log_level = "info"
max_connections = 2000

[cache]
size_mb = 4096  # Large shared cache
ttl_seconds = 14400  # 4 hours
compression = true
compression_level = 4
eviction_policy = "lru"
use_mmap = true

[deduplication]
enabled = true
hash_algorithm = "blake3"
min_layer_size = 1048576
max_concurrent_dedup = 16
enable_bloom_filter = true
bloom_filter_capacity = 5000000

[prediction]
enabled = true
update_interval = 180  # More frequent updates
min_confidence = 0.60
max_predictions = 30
history_retention_days = 30
incremental_models = true

[prewarming]
enabled = true
parallel_ops = 16
timeout_seconds = 90
prefetch_depth = 4  # Aggressive prefetching
batch_warming = true
batch_size = 500

[monitoring]
metrics_enabled = true
metrics_port = 8888
collection_interval = 5
enable_histograms = true
enable_percentiles = true
export_enabled = true
export_interval = 10
export_targets = [
    "http://prometheus-primary:9090/api/v1/write",
    "http://prometheus-backup:9090/api/v1/write"
]

[resilience]
max_retries = 10
initial_retry_delay_ms = 50
max_retry_delay_ms = 30000
retry_backoff_multiplier = 1.5
circuit_breaker_enabled = true
circuit_breaker_threshold = 70
circuit_breaker_timeout_secs = 120
graceful_degradation = true
fallback_to_baseline = true

# Replication settings (additional)
[replication]
enabled = true
replication_factor = 3
consistency_level = "quorum"
sync_interval_secs = 10
